--2022 ACTUALS AND 20% INCREASE FORECASTED
SELECT 
COUNT(X.ORDNUM) as 'Number of Orders'
,(COUNT(X.ORDNUM))*.2)+COUNT(X.ORDNUM)) as 'Number of Orders Forecasted'
,METHOD
,CARRIER
,SEND_DATE
,ORDER_CAT
,DAY
,DATEPART(M,X.SEND_DATE) AS 'MONTH'
,DATEPART(D,X.SEND_DATE) AS 'DATE'
 FROM
    (SELECT 
    S.ORDNUM
    ,S.SEND_DATE
    ,S.METHOD
    ,CASE 
      WHEN S.METHOD IN ('DHL', 'EX') THEN 'DHL'
      WHEN S.METHOD IN ('2','S','P') THEN 'FedEx Express'
      WHEN S.METHOD = 'UPS' THEN 'UPS'
    END AS 'CARRIER'
    ,CASE 
      WHEN (ORDNUM LIKE '5%') THEN 'B2B'
      WHEN (S.ID = 'COM') THEN 'Commercial'
    ELSE 'Ecommerce'
    END AS ORDER_CAT
    ,CASE
      WHEN DATEPART(DW,S.SEND_DATE) = 1 THEN 'SUN'
      WHEN DATEPART(DW,S.SEND_DATE) = 2 THEN 'MON'
      WHEN DATEPART(DW,S.SEND_DATE) = 3 THEN 'TUE'
      WHEN DATEPART(DW,S.SEND_DATE) = 4 THEN 'WED'
      WHEN DATEPART(DW,S.SEND_DATE) = 5 THEN 'THU'
      WHEN DATEPART(DW,S.SEND_DATE) = 6 THEN 'FRI'
      WHEN DATEPART(DW,S.SEND_DATE) = 7 THEN 'SAT' 
    END AS [DAY]
    ,DATEPART(M,S.SEND_DATE) AS MONTH
    ,DATEPART(D,S.SEND_DATE) AS DATE
    
    FROM ORDERS S
    LEFT JOIN SHIPMENTS D ON D.ORDNUM = S.ORDNUM
    ) X
WHERE CARRIER IN ('FedEx Express', 'UPS', 'DHL')
and ORDER_CAT IN ('Ecommerce','B2B','Commercial')
and SEND_DATE BETWEEN '2022-07-01' AND '2022-09-31'
GROUP BY X.CARRIER,SEND_DATE, ORDERCAT, METHOD, DAY


--2023 ACTUALS
SELECT 
COUNT(X.ORDNUM) as 'Number of Orders 2023'
,METHOD
,CARRIER
,SEND_DATE
,ORDER_CAT
,DAY
,DATEPART(M,X.SEND_DATE) AS 'MONTH'
,DATEPART(D,X.SEND_DATE) AS 'DATE'
 FROM
    (SELECT 
    S.ORDNUM
    ,S.SEND_DATE
    ,S.METHOD
    ,CASE 
      WHEN S.METHOD IN ('DHL', 'EX') THEN 'DHL'
      WHEN S.METHOD IN ('2','S','P') THEN 'FedEx Express'
      WHEN S.METHOD = 'UPS' THEN 'UPS'
    END AS 'CARRIER'
    ,CASE 
      WHEN (ORDNUM LIKE '5%') THEN 'B2B'
      WHEN (S.ID = 'COM') THEN 'Commercial'
    ELSE 'Ecommerce'
    END AS ORDER_CAT
    ,CASE
      WHEN DATEPART(DW,S.SEND_DATE) = 1 THEN 'SUN'
      WHEN DATEPART(DW,S.SEND_DATE) = 2 THEN 'MON'
      WHEN DATEPART(DW,S.SEND_DATE) = 3 THEN 'TUE'
      WHEN DATEPART(DW,S.SEND_DATE) = 4 THEN 'WED'
      WHEN DATEPART(DW,S.SEND_DATE) = 5 THEN 'THU'
      WHEN DATEPART(DW,S.SEND_DATE) = 6 THEN 'FRI'
      WHEN DATEPART(DW,S.SEND_DATE) = 7 THEN 'SAT' 
    END AS [DAY]
    ,DATEPART(M,S.SEND_DATE) AS MONTH
    ,DATEPART(D,S.SEND_DATE) AS DATE
    
    FROM ORDERS S
    LEFT JOIN SHIPMENTS D ON D.ORDNUM = S.ORDNUM
    ) X
WHERE CARRIER IN ('FedEx Express', 'UPS', 'DHL')
and ORDER_CAT IN ('Ecommerce','B2B','Commercial')
and SEND_DATE BETWEEN '2023-07-01' AND '2023-09-31'
GROUP BY X.CARRIER,SEND_DATE, ORDERCAT, METHOD, DAY
