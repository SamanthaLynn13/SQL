--2022 ACTUALS AND 20% INCREASE PROJECTION
SELECT 
COUNT(X.ORDNUM) as 'Number of Orders'
,(COUNT(X.ORDNUM))*.2)+COUNT(X.ORDNUM)) as 'Number of Orders Projected'
,METHOD
,CARRIER
,SHIPDATE
,ORDERTYPE
,DAY
,DATEPART(M,X.SHIPDATE) AS 'MONTH'
,DATEPART(D,X.SHIPDATE) AS 'DATE'
 FROM
(SELECT 
S.ORDNUM
,S.SHIPDATE
,S.METHOD
,CASE WHEN S.METHOD IN ('PICKUP','DELIVERY') THEN 'N/A'
WHEN S.METHOD IN ('GND','GHD') THEN 'FedEx Ground'
WHEN S.METHOD IN ('2','SO','PO') THEN 'FedEx Express'
WHEN S.METHOD = 'UPS' THEN 'UPS'
END AS 'CARRIER'
,CASE 
WHEN (ORDNUM LIKE '5%') THEN 'B2B'
WHEN (S.ID = 'WHL') THEN 'Wholesale'
ELSE 'Ecommerce'
END AS ORDERTYPE
,CASE
WHEN DATEPART(DW,S.SHIPDATE) = 1 THEN 'SUN'
WHEN DATEPART(DW,S.SHIPDATE) = 2 THEN 'MON'
WHEN DATEPART(DW,S.SHIPDATE) = 3 THEN 'TUE'
WHEN DATEPART(DW,S.SHIPDATE) = 4 THEN 'WED'
WHEN DATEPART(DW,S.SHIPDATE) = 5 THEN 'THU'
WHEN DATEPART(DW,S.SHIPDATE) = 6 THEN 'FRI'
WHEN DATEPART(DW,S.SHIPDATE = 7 THEN 'SAT' 
END AS [DAY]
,DATEPART(M,S.SHIPDATE) AS MONTH
,DATEPART(D,S.SHIPDATE) AS DATE

FROM ORDERS S
LEFT JOIN SHIPMENTS D ON D.ORDNUM = S.ORDNUM
) X
WHERE CARRIER IN ('FedEx Express', 'UPS', 'FedEx Ground')
and ORDERTYPE IN ('Ecommerce','B2B','Wholesale')
and SHIPDATE BETWEEN '2022-07-01' AND '2022-09-31'
GROUP BY X.CARRIER,SHIPDATE, ORDERTYPE, METHOD, DAY


--2023 ACTUALS
SELECT 
COUNT(X.ORDNUM) as 'Number of Orders'
,(COUNT(X.ORDNUM))*.2)+COUNT(X.ORDNUM)) as 'Number of Orders Projected'
,METHOD
,CARRIER
,SHIPDATE
,ORDERTYPE
,DAY
,DATEPART(M,X.SHIPDATE) AS 'MONTH'
,DATEPART(D,X.SHIPDATE) AS 'DATE'
 FROM
(SELECT 
S.ORDNUM
,S.SHIPDATE
,S.METHOD
,CASE WHEN S.METHOD IN ('PICKUP','DELIVERY') THEN 'N/A'
WHEN S.METHOD IN ('GND','GHD') THEN 'FedEx Ground'
WHEN S.METHOD IN ('2D','SO','PO') THEN 'FedEx Express'
WHEN S.METHOD = 'UPS' THEN 'UPS'
END AS 'CARRIER'
,CASE 
WHEN (ORDNUM LIKE '5%') THEN 'B2B'
WHEN (S.ID = 'WHL') THEN 'Wholesale'
ELSE 'Ecommerce'
END AS ORDERTYPE
,CASE
WHEN DATEPART(DW,S.SHIPDATE) = 1 THEN 'SUN'
WHEN DATEPART(DW,S.SHIPDATE) = 2 THEN 'MON'
WHEN DATEPART(DW,S.SHIPDATE) = 3 THEN 'TUE'
WHEN DATEPART(DW,S.SHIPDATE) = 4 THEN 'WED'
WHEN DATEPART(DW,S.SHIPDATE) = 5 THEN 'THU'
WHEN DATEPART(DW,S.SHIPDATE) = 6 THEN 'FRI'
WHEN DATEPART(DW,S.SHIPDATE = 7 THEN 'SAT' 
END AS [DAY]
,DATEPART(M,S.SHIPDATE) AS MONTH
,DATEPART(D,S.SHIPDATE) AS DATE

FROM ORDERS S
LEFT JOIN SHIPMENTS D ON D.ORDNUM = S.ORDNUM
) X
WHERE CARRIER IN ('FedEx Express', 'UPS', 'FedEx Ground')
and ORDERTYPE IN ('Ecommerce','B2B','Wholesale')
and SHIPDATE BETWEEN '2023-07-01' AND '2023-09-31'
GROUP BY X.CARRIER,SHIPDATE, ORDERTYPE, METHOD, DAY
